<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Canci贸n Interactiva</title>
<style>
:root {
  --vh: 100%;
}

body, #inicio {
  margin: 0;
  font-family: 'Helvetica Neue', Arial, sans-serif;
  height: calc(var(--vh) * 100);
  overflow: hidden;
  background: linear-gradient(270deg, #ff5f6d, #ffc371, #24c6dc, #514a9d);
  background-size: 800% 800%;
  animation: gradientBG 20s ease infinite;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  position: relative;
}

/* Animaci贸n de fondo */
@keyframes gradientBG {
  0% {background-position:0% 50%;}
  50% {background-position:100% 50%;}
  100% {background-position:0% 50%;}
}

/* Pantalla inicial */
#inicio {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  z-index: 10;
}

#inicio h2 {
  font-size: 26px;
  margin-bottom: 20px;
  text-shadow: 0 0 10px rgba(0,0,0,0.5);
}

button {
  padding: 14px 35px;
  border: none;
  border-radius: 50px;
  background: #fff;
  color: #111;
  font-size: 18px;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  transition: transform 0.2s;
}

button:hover {
  transform: scale(1.05);
}

/* Pop-up */
.popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255,255,255,0.95);
  color: #111;
  padding: 35px 30px;
  border-radius: 25px;
  max-width: 450px;
  width: 90%;
  text-align: center;
  box-shadow: 0 12px 35px rgba(0,0,0,0.5);
  opacity: 0;
  transition: opacity 0.6s ease;
  font-size: 22px;
  line-height: 1.8;
  z-index: 20;
}

/* Part铆culas */
.particle {
  position: absolute;
  width: 6px;
  height: 6px;
  background: rgba(255,255,255,0.7);
  border-radius: 50%;
  pointer-events: none;
  animation: floatParticle linear infinite;
}

@keyframes floatParticle {
  0% {transform: translateY(0) translateX(0);}
  100% {transform: translateY(-120vh) translateX(20px);}
}

/* Fade In/Out */
.show { opacity: 1; }
.hide { opacity: 0; }

/* Leyenda abajo */
#leyenda {
  position: fixed;
  bottom: 15px;
  width: 100%;
  text-align: center;
  font-size: 20px;
  color: #fff;
  font-weight: bold;
  text-shadow: 0 0 8px rgba(0,0,0,0.7);
  z-index: 30;
  pointer-events: none;
}
</style>
</head>
<body>

<!-- Part铆culas -->
<div id="particles"></div>

<!-- Pantalla inicial -->
<div id="inicio">
  <h2> Toca para empezar la canci贸n </h2>
  <button id="startBtn">Iniciar</button>
</div>

<!-- Pop-up -->
<div class="popup" id="popup">
  <div class="letra" id="texto"></div>
</div>

<!-- Leyenda fija -->
<div id="leyenda">JJ</div>

<!-- Audio Beat -->
<audio id="beat">
  <source src="beat.mp3" type="audio/mpeg">
  Tu navegador no soporta audio
</audio>

<script>
// Ajustar altura en iPhone y m贸viles
function actualizarAltura() {
  let vh = window.innerHeight * 0.01;
  document.documentElement.style.setProperty('--vh', `${vh}px`);
}
window.addEventListener('resize', actualizarAltura);
actualizarAltura();

// Frases y duraci贸n
const letra = [
  "Yo no soy celoso, 驴pero qui茅n e'ese ...?",
  "Dime qui茅n e'ese ...",
  "Tranquila, no soy psycho",
  "No vo'a hacer un papel贸n, pero",
  "Auch, mi coraz贸n"
];
const duracion = [4000, 1500, 2000, 1700, 1500]; // ms por popup

const texto = document.getElementById("texto");
const popup = document.getElementById("popup");
const beat = document.getElementById("beat");
let indice = 0;

// Crear part铆culas
const particlesContainer = document.getElementById("particles");
for(let i=0; i<30; i++){
  let p = document.createElement("div");
  p.className = "particle";
  p.style.left = Math.random()*100 + "vw";
  p.style.top = Math.random()*100 + "vh";
  p.style.animationDuration = 5 + Math.random()*5 + "s";
  p.style.width = 2 + Math.random()*6 + "px";
  p.style.height = p.style.width;
  particlesContainer.appendChild(p);
}

// Mostrar popup letra por letra
function mostrarPopup() {
  if(indice < letra.length){
    popup.classList.add('show');
    popup.classList.remove('hide');
    texto.innerHTML = "";

    let chars = letra[indice].split("");
    let i = 0;
    let interval = setInterval(() => {
      texto.innerHTML += chars[i];
      i++;
      if(i >= chars.length) clearInterval(interval);
    }, 50); // velocidad por letra

    // Inicia beat en primer popup
    if(indice===0){
      beat.volume = 0;
      beat.play().then(()=>{
        let vol=0;
        let fade = setInterval(()=>{
          vol+=0.02;
          if(vol>=0.3){ beat.volume=0.3; clearInterval(fade); }
          else beat.volume=vol;
        },50);
      }).catch(()=>console.log("Toca la pantalla para iniciar audio si Safari lo bloquea"));
    }

    setTimeout(()=>{
      popup.classList.remove('show');
      popup.classList.add('hide');
      setTimeout(()=>{
        indice++;
        mostrarPopup();
      },600);
    }, duracion[indice]);
  } else {
    // Fin de popups
    popup.classList.remove('show');
    popup.classList.add('hide');
    // Fade out del beat
    let fade = setInterval(()=>{
      if(beat.volume>0.02){
        beat.volume-=0.02;
      } else {
        beat.pause();
        beat.currentTime=0;
        clearInterval(fade);
      }
    },50);
  }
}

// Bot贸n inicio
document.getElementById("startBtn").addEventListener("click",()=>{
  document.getElementById("inicio").style.display="none";
  mostrarPopup();
});
</script>

</body>
</html>
